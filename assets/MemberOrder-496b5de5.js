import{P as C}from"./ProductModal-82bf9fc3.js";import{_ as A,m as h,a as u,r as f,o as i,c as r,b as t,t as o,n as p,d,F as D,e as O,f as g,g as S,k as c,p as y,l as v,u as x}from"./index-77334642.js";import{u as N}from"./utilitiesStore-f3e398c9.js";const P={components:{ProductModal:C},data(){return{order:null,clickedCourse:{},id:this.$route.params.id,hexApi:"https://ec-course-api.hexschool.io/v2/",apiPath:"2023shuttle"}},computed:{...h(y,["alertstyles"]),...h(v,["singleInfo"]),...h(x,["numActivities","unlimitedActivities"]),originBill(){return Object.values(this.order.products).reduce((l,_)=>l+_.product.origin_price*_.qty,0)},finalBill(){return this.order.total},activities(){return{...this.numActivities,...this.unlimitedActivities}}},methods:{...u(y,["baseContent"]),...u(v,["getFontData"]),...u(x,["getActivities"]),...u(N,["unixToStr"]),noticePaied(n){this.axios.post(`${this.hexApi}api/${this.apiPath}/pay/${n}`).then(()=>{this.alertstyles.toast.fire("完成付款通知"),this.getFontData("order",n)}).catch(l=>{this.alertstyles.toast_danger.fire(`問題${l.response.status}，抱歉請洽客服`)})}},watch:{singleInfo(n){this.order={...n}}},mounted(){this.getFontData("order",this.id),this.getActivities()}},j={class:"bg-white p-7 py-md-5 rounded"},q=t("h2",{class:"title fs-4 text-primary mb-7 mb-md-5"},[t("span",{class:"border-primary"},"訂單明細")],-1),B={key:0},F={class:"d-flex justify-content-between px-3 mb-4"},T={class:"list-unstyled mb-0"},M={class:"py-1"},V={class:"py-1"},I=["disabled"],L={class:"table table-white text-center align-middle"},R=t("thead",null,[t("tr",null,[t("th",{scope:"col",width:"120"},"預覽圖片"),t("th",{scope:"col"},"課程名稱"),t("th",{scope:"col"},"原價"),t("th",{scope:"col"},"人數"),t("th",{scope:"col"},"小計"),t("th",{scope:"col",width:"140"})])],-1),z=["src","alt"],E={class:"fs-7 mb-0"},U={key:0},G={key:0,class:"text-danger d-block"},H={key:0,class:"text-danger d-block"},J=["onClick"],K={class:"d-flex align-items-end justify-content-between px-3"},Q=t("span",{class:"material-symbols-outlined icon-semibold me-1"},"undo",-1),W=t("span",{class:"align-middle border-bottom"},"返回訂單列表",-1),X={class:"list-group rounded-2 text-mellow"},Y={class:"list-group-item border-0 d-flex justify-content-between py-2"},Z={class:"fw-bold ms-2"},$={key:0,class:"list-group-item border-0 d-flex justify-content-between py-2"},tt={class:"fw-bold ms-2 text-danger"},et={key:1,class:"list-group-item border-0 d-flex justify-content-between py-2"},st={class:"fw-bold ms-2 text-danger"},ot={class:"list-group-item border-0 d-flex justify-content-between py-2"},it={class:"fw-bold ms-2"};function rt(n,l,_,nt,s,a){const w=f("RouterLink"),k=f("ProductModal");return i(),r("div",j,[q,s.order?(i(),r("div",B,[t("div",F,[t("ul",T,[t("li",M,"訂單編號："+o(s.order.id),1),t("li",V,"成立日期："+o(n.unixToStr(s.order.create_at)),1)]),t("div",null,[t("button",{class:"btn btn-sm fs-8 btn-outline-primary shadow-sm align-top",disabled:s.order.is_paid,onClick:l[0]||(l[0]=e=>a.noticePaied(s.id)),type:"button"},[t("i",{class:p(["bi",[s.order.is_paid?"bi-bell-fill":"bi-bell"]])},null,2),d(" "+o(s.order.is_paid?"已通知付款":"通知付款"),1)],8,I),t("span",{class:p(["badge text-white rounded-1 fs-7 ms-2",[s.order.is_paid?"bg-success":"bg-danger"]])},o(s.order.is_paid?"完成付款":"未付款"),3)])]),t("table",L,[R,t("tbody",null,[(i(!0),r(D,null,O(s.order.products,e=>{var m,b;return i(),r("tr",{key:e.id},[t("td",null,[t("img",{src:e.product.imageUrl,alt:e.product.title,style:{height:"100px"}},null,8,z)]),t("td",null,[t("h3",E,o(e.product.title),1),e.product.state.promotion?(i(),r("small",U," 適用優惠："+o(a.activities[e.product.state.promotion].title),1)):c("",!0)]),t("td",null,[t("span",{class:p({"text-decoration-line-through":e.product.origin_price!==e.product.price})},o(e.product.origin_price),3),e.product.origin_price!==e.product.price?(i(),r("span",G,o(e.product.price),1)):c("",!0)]),t("td",null,o(e.qty)+" 位",1),t("td",null,[t("span",{class:p({"text-decoration-line-through":((m=a.activities[e.product.state.promotion])==null?void 0:m.requiredNum)===e.qty})},o(e.total),3),((b=a.activities[e.product.state.promotion])==null?void 0:b.requiredNum)===e.qty?(i(),r("span",H,o(e.total*a.activities[e.product.state.promotion].percentOff),1)):c("",!0)]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary p-2 mx-2 w-75 fs-8 shadow-none","data-bs-toggle":"modal","data-bs-target":"#productInfo",onClick:lt=>s.clickedCourse={...e}}," 課程資訊 ",8,J)])])}),128))])]),t("div",K,[g(w,{class:"text-end fs-8 pt-5",to:"/member/orders"},{default:S(()=>[Q,W]),_:1}),t("ul",X,[t("li",Y,[d(" 原始金額： "),t("span",Z,"NT$ "+o(s.order.user.cartOverview.sumSubtotals),1)]),s.order.user.cartOverview.couponDiscount?(i(),r("li",$,[d(" 優惠券折抵： "),t("span",tt," -"+o(s.order.user.cartOverview.couponDiscount),1)])):c("",!0),s.order.user.cartOverview.fullDiscount?(i(),r("li",et,[d(" 滿額折抵： "),t("span",st," -"+o(s.order.user.cartOverview.fullDiscount),1)])):c("",!0),t("li",ot,[d(" 訂單總金額： "),t("span",it,"NT$ "+o(s.order.user.cartOverview.finalBill),1)])])])])):c("",!0),g(k,{"clicked-course":s.clickedCourse},null,8,["clicked-course"])])}const ut=A(P,[["render",rt]]);export{ut as default};
