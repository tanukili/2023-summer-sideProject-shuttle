import{_ as B,m as g,b as p,r as f,o as r,c as a,g as h,a as t,h as _,e as F,v as L,F as m,f as v,u as y,d as k,n as u,w as C,t as l,k as T,i as V}from"./index-686eedae.js";import{u as x}from"./useProductsStore-08c41425.js";import{u as P}from"./useFavoriteStore-4c95463f.js";import{B as E}from"./BackgroundBanner-ce8413c2.js";const $={components:{BackgroundBanner:E},data(){return{bannerImg:"banner/banner-products.png",categories:["全部課程","一日體驗","初階課程","輔助課程"],nowCategory:0,nowSort:"CtoE",showProducts:[]}},computed:{...g(x,["products","pagination"]),...g(y,["numActivities","unlimitedActivities"]),...g(P,["favorites"]),activies(){return{...this.numActivities,...this.unlimitedActivities}}},watch:{products(e){this.showProducts=[...e],this.nowCategory?this.changeCategory(this.nowCategory):window.scrollTo(0,0)},nowCategory(){this.sortProducts(this.nowSort)},nowSort(e){this.sortProducts(e)}},methods:{...p(x,["getProducts","getAllProducts"]),...p(y,["getActivities"]),...p(P,["toggleFavorite","getFavorites"]),changeCategory(e){this.nowCategory=e;const o=["","體驗","初階","輔助"];e?this.showProducts=[...this.products.filter(i=>i.category===o[e])]:this.showProducts=[...this.products],window.scrollTo(0,360)},sortProducts(e){switch(e){case"CtoE":this.showProducts=this.showProducts.sort((o,i)=>o.price-i.price);break;case"EtoC":this.showProducts=this.showProducts.sort((o,i)=>i.price-o.price);break;case"LtoS":this.showProducts=this.showProducts.sort((o,i)=>i.info.classTime.length-o.info.classTime.length);break;case"StoL":this.showProducts=this.showProducts.sort((o,i)=>-i.info.classTime.length+o.info.classTime.length);break;default:this.showProducts=this.showProducts.sort((o,i)=>i.info.capacity-o.info.capacity);break}}},mounted(){this.getAllProducts(),this.getActivities(),this.getFavorites(),this.nowCategory=parseInt(document.cookie.replace(/(?:(?:^|.*;\s*)productCategory\s*=\s*([^;]*).*$)|^.*$/,"$1"),10)},beforeUnmount(){document.cookie="productCategory=0; max-age=86400;Secure"}},I={class:"bg-white"},N={class:"block-spacing-sm container"},O={"aria-label":"breadcrumb"},U={class:"breadcrumb fs-8 fs-lg-7"},D={class:"breadcrumb-item"},M=t("li",{class:"breadcrumb-item active","aria-current":"page"},"購買課程",-1),R=t("h2",{class:"title fs-3 fs-lg-2 mb-md-5"},[t("span",{class:"border-primary pb-2 pb-lg-3"},"課程一覽")],-1),z={class:"d-flex align-items-center mb-2"},j=t("label",{for:"filter-select",class:"lh-lg fw-semibold flex-shrink-0 me-2 ms-auto"},"排序",-1),q={class:"select-icon"},G=V('<option value="" selected>推薦課程</option><option value="CtoE">價格由低到高</option><option value="EtoC">價格由高到低</option><option value="LtoS">上課天數長到短</option><option value="StoL">上課天數短到長</option>',5),H=[G],J={class:"row"},K={class:"sidebar-sticky col-md-2 col-lg-3 col-xl-2 mb-4 mb-md-0 fs-8 fs-lg-7"},Q={class:"nav nav-underline flex-md-column bg-primary-light rounded-1 p-3 p-lg-4"},W=["onClick"],X={class:"col"},Y={class:"row g-3 gx-xxl-4 px-4 px-md-0"},Z={class:"card-mask position-relative"},tt=["src","alt"],st=["onClick","title"],et={class:"card-body flex-grow-1 pb-3"},ot={class:"card-title fs-5"},it={class:"card-footer pb-3 pt-0"},rt={class:"d-flex align-items-center"},at={key:0,class:"fs-4 fw-bold text-danger"};function nt(e,o,i,ct,n,b){const S=f("BackgroundBanner"),w=f("RouterLink"),A=f("router-link");return r(),a(m,null,[h(S,{bannerImg:n.bannerImg},null,8,["bannerImg"]),t("div",I,[t("div",N,[t("nav",O,[t("ol",U,[t("li",D,[h(w,{to:"/"},{default:_(()=>[k("首頁")]),_:1})]),M])]),R,t("div",z,[j,t("div",q,[F(t("select",{"onUpdate:modelValue":o[0]||(o[0]=s=>n.nowSort=s),class:"form-select fs-7 border-secondary","aria-label":"form-select",id:"filter-select"},H,512),[[L,n.nowSort]])])]),t("div",J,[t("div",K,[t("nav",Q,[(r(!0),a(m,null,v(n.categories,(s,c)=>(r(),a("a",{key:c,class:u(["flex-fill text-center nav-link",{active:n.nowCategory===c}]),href:"#",onClick:C(d=>b.changeCategory(c),["prevent"])},l(s),11,W))),128))])]),t("div",X,[t("div",Y,[(r(!0),a(m,null,v(n.showProducts,s=>(r(),a("div",{key:s.id,class:"col-md-6 col-xl-4"},[h(A,{to:`product/${s.id}`,class:"card h-100"},{default:_(()=>{var c;return[t("div",Z,[t("img",{src:s.imageUrl,alt:`product${s.id}`,class:"rounded-top",style:{height:"200px"}},null,8,tt),t("span",{class:u(["badge text-white position-absolute fs-7 px-6 py-2",[e.numActivities[s.state.promotion]?"bg-warning":"bg-success"]]),style:{top:"16px",left:"-4px"}},l((c=b.activies[s.state.promotion])==null?void 0:c.badge),3),t("a",{href:"#",onClick:C(d=>e.toggleFavorite(s.id),["prevent"]),title:[e.favorites.indexOf(s.id)!==-1?"移除收藏":"加入收藏"]},[t("span",{class:u(["icon-favorite material-symbols-outlined position-absolute",{"icon-fill text-danger":e.favorites.indexOf(s.id)!==-1}]),style:{top:"12px",right:"12px"}}," favorite ",2)],8,st)]),t("div",et,[t("h3",ot,l(s.title),1),(r(!0),a(m,null,v(s.info.tags,d=>(r(),a("span",{class:"badge bg-light me-1 mb-1",key:s.info.tags.indexOf(d)},l(d),1))),128))]),t("div",it,[t("div",rt,[e.unlimitedActivities[s.state.promotion]?(r(),a("small",at," $"+l(s.origin_price*e.unlimitedActivities[s.state.promotion].percentOff),1)):T("",!0),t("small",{class:u([e.unlimitedActivities[s.state.promotion]?"fs-6 text-gray-400 text-decoration-line-through ms-2":"fs-4 fw-bold text-black"])}," $"+l(s.origin_price),3)]),h(w,{to:`/product/${s.id}`,class:"btn btn-primary w-100 fs-md-7 mt-3"},{default:_(()=>[k(" 前往購買 ")]),_:2},1032,["to"])])]}),_:2},1032,["to"])]))),128))])])])])])],64)}const ut=B($,[["render",nt]]);export{ut as default};
