import{p as u,q as h,Q as c,s as n}from"./index-686eedae.js";const{alertstyles:t,baseContent:o}=u(),m=h("memberStore",{state:()=>({url:"https://sideproject-shuttle.onrender.com",userId:null,userToken:null,userInfo:{},userComments:[]}),getters:{},actions:{checkUserId(){this.userToken=document.cookie.replace(/(?:(?:^|.*;\s*)token\s*=\s*([^;]*).*$)|^.*$/,"$1"),this.userId=document.cookie.replace(/(?:(?:^|.*;\s*)userId\s*=\s*([^;]*).*$)|^.*$/,"$1"),this.userToken||(t.toast_danger.fire("無法確認身分，請先登入"),c.replace({name:"login"}))},getUserInfo(e,r){n.get(`${this.url}/600/users/${e}`,{headers:{Authorization:`Bearer ${r}`}}).then(s=>{this.userInfo=s.data}).catch(s=>{t.toast_danger.fire(o(`無法取得資料 問題${s.response.status}`))})},putUserInfo(e,r,s){const a={...s};delete a.checkPassword,n.put(`${this.url}/600/users/${e}`,a,{headers:{Authorization:`Bearer ${r}`}}).then(i=>{this.userInfo=i.data,t.toast.fire(o("更新成功")),this.getUserInfo(e,r)}).catch(i=>{t.toast_danger.fire(o(`更新失敗 問題${i.response.status}`))})},getUserCommits(){n.get(`${this.url}/600/comments?userId=${this.userId}`,{headers:{Authorization:`Bearer ${this.userToken}`}}).then(e=>{this.userComments=[...e.data]}).catch(e=>{t.toast_danger.fire(o(`無法取得心得 問題${e.response.status}`))})},postComment(e,r){const s={userId:+this.userId,...e};n.post(`${this.url}/660/comments`,s,{headers:{Authorization:`Bearer ${this.userToken}`}}).then(()=>{t.toast.fire("成功送出心得！"),r.hide(),this.getUserCommits()}).catch(a=>{t.toast_danger.fire(o(`新增失敗 問題${a.response.status}`))})}}});export{m};
